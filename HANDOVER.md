# Japan-Disaster-Alert 引継ぎ資料

## 最終更新: 2025-12-16

## プロジェクト概要
日本の災害情報（地震、津波、天気）を16言語で提供するリアルタイム防災アプリケーション

## 技術スタック
- **Frontend**: Next.js 15.5.9, React 19, TypeScript, Tailwind CSS
- **Backend**: FastAPI (Python)
- **地図**: Leaflet / react-leaflet（国土地理院タイル使用）
- **PWA**: Service Worker, Web App Manifest

---

## 今回の実装内容 (2025-12-16)

### 1. アクセシビリティ強化
- **ARIA属性追加**: タブナビゲーション（`role="tablist"`, `aria-selected`, `aria-controls`）
- **フォーカス管理**: キーボードナビゲーション対応（`tabIndex`, `focus:ring`）
- **スクリーンリーダー対応**: `aria-label`, `aria-hidden`, `sr-only`クラス
- **タブパネル**: 全タブコンテンツに`role="tabpanel"`を追加

### 2. エラーハンドリング改善
- **Error Boundaryコンポーネント**: 予期せぬエラーをキャッチして多言語メッセージを表示
- **API エラー表示**: ネットワークエラー/サーバーエラーの区別、リトライボタン
- **多言語エラーメッセージ**: 日本語、英語、やさしい日本語、中国語、韓国語、ベトナム語

### 3. PWA対応（新規）
- **manifest.json**: アプリアイコン、ショートカット、スクリーンショット設定
- **Service Worker (sw.js)**:
  - キャッシュ戦略（静的アセット、API、地図タイル）
  - オフライン対応
  - プッシュ通知対応
  - バックグラウンド同期
- **offline.html**: 多言語対応のオフラインページ（緊急連絡先付き）
- **ServiceWorkerRegistration.tsx**: SW登録コンポーネント

### 4. チェックリスト16言語対応
防災チェックリストを全16言語に拡張:
- 日本語 / English / 简体中文 / 繁體中文
- 한국어 / Tiếng Việt / ไทย / Bahasa Indonesia
- Bahasa Malaysia / Filipino / नेपाली / Français
- Deutsch / Italiano / Español / やさしい日本語

### 5. UI/UX改善
- **テキストカラー修正**: 防災グッズチェックリストの文字色を`text-gray-800`に修正
- **高コントラストモード対応**: `@media (prefers-contrast: high)`
- **モーション軽減対応**: `@media (prefers-reduced-motion: reduce)`

---

## 変更ファイル一覧

### 新規作成
| ファイル | 説明 |
|---------|------|
| `frontend/public/manifest.json` | PWAマニフェスト |
| `frontend/public/sw.js` | Service Worker |
| `frontend/public/offline.html` | オフラインページ |
| `frontend/src/components/ServiceWorkerRegistration.tsx` | SW登録 |
| `frontend/src/components/EmergencyAlert.tsx` | 緊急警報オーバーレイ |
| `frontend/src/components/IntensityGauge.tsx` | 震度ゲージ |
| `frontend/src/components/TsunamiAlert.tsx` | 津波警報 |
| `frontend/src/components/ShelterMap.tsx` | 避難所マップ |
| `frontend/src/components/icons/DisasterIcons.tsx` | 災害アイコン |

### 変更
| ファイル | 変更内容 |
|---------|----------|
| `frontend/src/app/page.tsx` | Error Boundary, ARIA属性, エラーハンドリング, 16言語チェックリスト |
| `frontend/src/app/layout.tsx` | PWA設定, Service Worker登録, viewport設定 |
| `frontend/src/app/globals.css` | アニメーション, 高コントラスト, モーション軽減 |
| `frontend/src/components/EarthquakeMap.tsx` | 色覚多様性対応パターン, 影響範囲円 |

---

## 次回の課題・TODO

### 高優先度
1. **PWAアイコン作成**: `public/icons/` にアイコン画像を追加
2. **避難所データAPI連携**: 現在はサンプルデータ、実際のAPIと接続必要
3. **プッシュ通知バックエンド**: FCM等のプッシュ通知サービス連携

### 中優先度
4. **テスト追加**: Jest/React Testing Libraryでのユニットテスト
5. **E2Eテスト**: Playwrightでの統合テスト
6. **パフォーマンス最適化**: 画像最適化、バンドルサイズ削減

### 低優先度
7. **ダークモード完全対応**: 現在CSSのみ、コンポーネント側の対応
8. **音声読み上げ対応**: 緊急警報の音声アナウンス

---

## 開発環境起動方法

```bash
# フロントエンド
cd frontend
npm install
npm run dev -- -p 3002

# バックエンド
cd backend
pip install -r requirements.txt
uvicorn main:app --reload --port 8000
```

---

## 注意事項
- PWAアイコンは未作成のため、本番環境ではアイコン画像の追加が必要
- Service Workerはlocalhostまたはhttps環境でのみ動作
- 避難所データはサンプル（東京エリア）のみ

---

*Generated by Claude Code - AI Orchestrator v5.3 Review*
